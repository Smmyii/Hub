# Codebase Structure

**Analysis Date:** 2026-02-02

## Directory Layout

```
/home/sammy/.config/hypr/
├── hyprland/                    # Base configuration and utilities
│   ├── env.conf                 # Environment variables
│   ├── execs.conf               # Startup services
│   ├── general.conf             # Compositor settings
│   ├── rules.conf               # Window and layer rules
│   ├── colors.conf              # Color definitions
│   ├── keybinds.conf            # Default keybindings
│   └── scripts/                 # Utility scripts
│       ├── workspace_action.sh   # Workspace dispatcher
│       ├── launch_first_available.sh  # App launcher fallback
│       ├── zoom.sh              # Cursor zoom control
│       ├── snip_to_search.sh    # Screenshot search
│       ├── fuzzel-emoji.sh      # Emoji picker
│       ├── start_geoclue_agent.sh     # Location services
│       └── ai/                  # AI-related scripts
│           ├── primary-buffer-query.sh
│           └── show-loaded-ollama-models.sh
├── custom/                      # User customizations (overrides)
│   ├── env.conf                 # Custom environment variables
│   ├── execs.conf               # Custom startup services
│   ├── general.conf             # Custom general settings
│   ├── rules.conf               # Custom window/layer rules
│   ├── keybinds.conf            # Custom keybindings
│   └── scripts/                 # Custom scripts
│       └── __restore_video_wallpaper.sh  # Generated by switchwall.sh
├── hyprlock/                    # Lock screen configuration
│   ├── colors.conf              # Lock screen colors (matugen-generated)
│   ├── status.sh                # Status display script
│   ├── check-capslock.sh        # Capslock indicator
│   └── (hyprlock.conf in root)  # Lock screen config
├── shaders/                     # Shader files
├── hypridle.conf                # Idle behavior configuration
├── hyprland.conf                # Main entry point (sources all configs)
├── hyprlock.conf                # Lock screen configuration
├── monitors.conf                # Monitor layout (auto-generated by nwg-displays)
├── workspaces.conf              # Workspace assignments (auto-generated by nwg-displays)
└── .planning/                   # Analysis and planning documents
    └── codebase/                # Codebase documentation
```

## Directory Purposes

**hyprland/:**
- Purpose: Default/base configuration and utility scripts
- Contains: Hyprland compositor settings, keybindings, window rules, startup services
- Key files: `keybinds.conf`, `rules.conf`, `execs.conf`, `general.conf`

**hyprland/scripts/:**
- Purpose: Reusable shell utilities for dynamic behavior
- Contains: Workspace management, application launching, media control, AI integration
- Key files: `workspace_action.sh`, `launch_first_available.sh`, `zoom.sh`

**hyprland/scripts/ai/:**
- Purpose: AI/LLM integration utilities
- Contains: Scripts for Ollama model queries and text processing
- Key files: `primary-buffer-query.sh`, `show-loaded-ollama-models.sh`

**custom/:**
- Purpose: User customization layer without modifying base configs
- Contains: User overrides for env, execs, general, rules, keybinds
- Key files: Mirrors structure of `hyprland/` for parallel configuration

**custom/scripts/:**
- Purpose: User-specific scripts and generated content
- Contains: Custom utilities and auto-generated restoration scripts
- Key files: `__restore_video_wallpaper.sh` (generated by colorscheme switch)

**hyprlock/:**
- Purpose: Lock screen configuration and utilities
- Contains: Lock screen colors, status display, input indicators
- Key files: `colors.conf` (matugen-generated), `status.sh`, `check-capslock.sh`

**shaders/:**
- Purpose: GPU shader programs for visual effects
- Contains: Custom shader implementations
- Key files: Depends on specific shader requirements

## Key File Locations

**Entry Points:**
- `/home/sammy/.config/hypr/hyprland.conf`: Main configuration file; sources all configs in order
- `/home/sammy/.config/hypr/hypridle.conf`: Idle daemon configuration (locks screen, suspends)
- `/home/sammy/.config/hypr/hyprlock.conf`: Lock screen appearance and behavior

**Configuration:**
- `/home/sammy/.config/hypr/hyprland/env.conf`: Wayland/Qt/theme environment variables
- `/home/sammy/.config/hypr/hyprland/general.conf`: Gaps, animations, input, gestures, decoration
- `/home/sammy/.config/hypr/hyprland/rules.conf`: Window/layer rules (float, blur, animations, tiling)
- `/home/sammy/.config/hypr/hyprland/colors.conf`: Color palette definitions
- `/home/sammy/.config/hypr/hyprland/keybinds.conf`: All keybindings organized by section

**Core Logic:**
- `/home/sammy/.config/hypr/hyprland/scripts/workspace_action.sh`: Translates numbered workspaces to monitor-relative IDs
- `/home/sammy/.config/hypr/hyprland/scripts/launch_first_available.sh`: Tries app commands until one succeeds
- `/home/sammy/.config/hypr/hyprland/scripts/zoom.sh`: Cursor zoom with min/max bounds

**Display Configuration:**
- `/home/sammy/.config/hypr/monitors.conf`: Monitor definitions (auto-generated, do not edit)
- `/home/sammy/.config/hypr/workspaces.conf`: Workspace-to-monitor mapping (auto-generated, do not edit)

## Naming Conventions

**Files:**
- `.conf`: Configuration files (sourced by Hyprland)
- `.sh`: Executable shell scripts
- `__prefix.sh`: Auto-generated scripts (e.g., `__restore_video_wallpaper.sh`)
- `custom_` or no prefix: User-authored content
- `colors.conf`: Color definitions (often auto-generated by tools like matugen)

**Directories:**
- `hyprland/`: Base configuration
- `custom/`: Customization overlays
- `scripts/`: Executable utilities (not sourced, executed)
- Lowercase: Standard organization
- `.planning/`: Documentation and analysis (metadata)

**Scripts:**
- Dash-separated words: `launch_first_available.sh`, `start_geoclue_agent.sh`
- Functional naming: Script name indicates primary purpose
- Subdirectories for domains: `ai/` for AI-related utilities

## Where to Add New Code

**New Keybinding:**
- Primary file: `/home/sammy/.config/hypr/custom/keybinds.conf` (not default file)
- Add to appropriate section (marked with `##! Section Name`)
- Use matching bind type: `bind`, `bindl`, `bindle`, `bindm`, `bindd` (see examples)
- Include comment with description; add `# [hidden]` if auxiliary binding

**New Script Utility:**
- Location: `/home/sammy/.config/hypr/hyprland/scripts/` (base) or `/home/sammy/.config/hypr/custom/scripts/` (custom)
- Naming: Use dash-separated lowercase name (e.g., `my_utility.sh`)
- Header: Start with `#!/usr/bin/env bash`
- Referenced from: `/home/sammy/.config/hypr/hyprland/keybinds.conf` via `exec` directive
- Pattern: Accept parameters, use `hyprctl` for compositor interaction, provide fallbacks

**New Window Rule:**
- Primary location: `/home/sammy/.config/hypr/custom/rules.conf`
- Format: `windowrule = match:class ^(ClassName)$, rule_name on/off`
- Matching criteria: class (application identifier), title (window title), float status
- Rule types: float, size, move, center, blur, shadow, pin, immediate, etc.

**New Layer Rule:**
- Primary location: `/home/sammy/.config/hypr/custom/rules.conf`
- Format: `layerrule = match:namespace pattern, rule_name on/off/value`
- Namespace examples: `quickshell:*`, `gtk-layer-shell`, `notifications`, custom overlay names
- Rule types: blur, animation, ignore_alpha, xray, no_anim

**New Startup Service:**
- Primary location: `/home/sammy/.config/hypr/custom/execs.conf`
- Format: `exec-once = command &` (single run) or `exec = command &` (each reload)
- Services started: Background daemons, UI shells, system integrations
- Timing: Early in boot (core services), then supplementary services
- Pattern: Redirect output if needed (e.g., `--hide-window` for GUI services)

**New Environment Variable:**
- Primary location: `/home/sammy/.config/hypr/custom/env.conf`
- Format: `env = VAR_NAME, value`
- Used by: Other config sections, scripts, subprocess environments
- Examples: Application paths, theme settings, feature flags, API endpoints

## Special Directories

**monitors.conf / workspaces.conf:**
- Purpose: Persistent display layout
- Generated: Yes (by nwg-displays tool on display change)
- Committed: Yes (to version control if applicable)
- Manual edit: Not recommended (overwritten by nwg-displays)
- Regeneration: Run nwg-displays GUI tool or reimport layout

**.planning/codebase/:**
- Purpose: Codebase analysis and documentation
- Generated: Yes (by `/gsd:map-codebase` command)
- Committed: Yes
- Manual edit: Not recommended (auto-generated analysis)
- Contents: ARCHITECTURE.md, STRUCTURE.md, CONVENTIONS.md, TESTING.md, CONCERNS.md

**custom/ directory:**
- Purpose: User customization without modifying base
- Generated: Partially (some scripts auto-generated)
- Committed: Yes (user's custom configuration)
- Mirror structure: Mirrors `hyprland/` for predictable overrides
- Override precedence: Sourced after `hyprland/` files, so they take priority

---

*Structure analysis: 2026-02-02*
